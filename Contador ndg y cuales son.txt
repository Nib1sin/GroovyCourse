import it.sydema.laweb.domain.Posizione
def l = []

def p = entityManager.createQuery("""
    select  new Map(
        p.id as posizioneId,
        p.ndgControparte as ndg
        
    )
    from    Posizione p
    where
            p.ndgControparte in (
            '7000000031'
,'7000000504'
,'7000000804'
,'7000005711'
,'7000010173'
,'7000014029'
,'8000021681'
,'7000021877'
,'7000021984'
,'7000023477'
,'7001012668'
,'7000024429'
,'8000025023'
,'7000027339'
,'7000027590'
,'675181'
,'8000030488'
,'7000147843'
,'7000035893'
,'8000037204'
,'8072275198'
,'8000039912'
,'7000046432'
,'8000048636'
,'7000050529'
,'302114'
,'8000054188'
,'8000055629'
,'7000056572'
,'8000057857'
,'8000059901'
,'7000062104'
,'7000062569'
,'7000063564'
,'8000063751'
,'8000065445'
,'7000065667'
,'8000066244'
,'8000066379'
,'8000066569'
,'7000068160'
,'7000071224'
,'8000071825'
,'7000074152'
,'7000076406'
,'7003165317'
,'7000084199'
,'8000088689'
,'8000092415'
,'8000092615'
,'7000093872'
,'7000095319'
,'7000095812'
,'7000105314'
,'7000106652'
,'810745'
,'7000106787'
,'8000110941'
,'7000112711'
,'7000113061'
,'7000114014'
,'7000116449'
,'8000116668'
,'8000116701'
,'8000117440'
,'8000117468'
,'7000119192'
,'8000119495'
,'8000120170'
,'8000120896'
,'7000899801'
,'8000122302'
,'7000122810'
,'7000123076'
,'7001429091'
,'7000124243'
,'7000124718'
,'8000129263'
,'7000130589'
,'742626'
,'7000132411'
,'7002553133'
,'7000134383'
,'7000134416'
,'7000137361'
,'7000137561'
,'7000137616'
,'7000138132'
,'8000143409'
,'8000143632'
,'7000144922'
,'7000757427'
,'7000145730'
,'7000146395'
,'7000148839'
,'7000150677'
,'7000151353'
,'7000152174'
,'7000152484'
,'7000152729'
,'8000153761'
,'8000154625'
,'7000156169'
,'7000156291'
,'8000157298'
,'7000157361'
,'7000158117'
,'7000160202'
,'7000160353'
,'7000162613'
,'7000172183'
,'7000173086'
,'7004315054'
,'7000173855'
,'7000174201'
,'7000174851'
,'8000175008'
,'7000177255'
,'7000178500'
,'7000180619'
,'7000180796'
,'7000181846'
,'7002489436'
,'7000182082'
,'8000183170'
,'7000185239'
,'7000185990'
,'7000188733'
,'7000190492'
,'7002768931'
,'7000191706'
,'7000192863'
,'7000192970'
,'7000194943'
,'7000198683'
,'8000199000'
,'7000204233'
,'7000205764'
,'7000206663'
,'7000206928'
,'7012537610'
,'12195645'
,'7000211228'
,'7000216102'
,'7000220513'
,'7000224020'
,'7002209698'
,'7000227600'
,'7000230269'
,'7000231528'
,'7002884098'
,'7000234028'
,'7000235062'
,'7000235190'
,'7000235544'
,'7000236217'
,'7000689248'
,'7000797379'
,'7000239246'
,'7003458729'
,'7000242077'
,'7000242519'
,'7000244074'
,'7000244710'
,'7000245139'
,'7001540290'
,'8000246362'
,'7000247385'
,'7013098230'
,'7000249997'
,'7000250998'
,'7003335707'
,'7000252880'
,'7000253599'
,'7000254500'
,'7003853004'
,'8000255706'
,'7000255895'
,'7000257850'
,'7001485406'
,'7000258900'
,'7000261746'
,'7000262686'
,'8000263822'
,'7000263913'
,'7002712532'
,'7000265995'
,'7000266045'
,'7000267242'
,'7000267793'
,'7000268062'
,'497470'
,'7007305470'
,'8000293353'
,'8000293688'
,'7000306061'
,'7000311607'
,'7000312872'
,'8000313271'
,'7000322158'
,'8000337700'
,'7000355221'
,'7000372906'
,'1382517'
,'7002487762'
,'7000382737'
,'374983'
,'7000386513'
,'8000387590'
,'7000391692'
,'8000399298'
,'7000399819'
,'7000402225'
,'7000402863'
,'7000403998'
,'7000407009'
,'7000412990'
,'7000415342'
,'7000415784'
,'7000423160'
,'7000425494'
,'531855'
,'7000427982'
,'7000428619'
,'7000429455'
,'7000431229'
,'7000432373'
,'7000432488'
,'7002841258'
,'7000435034'
,'7000436011'
,'7000451312'
,'7000783453'
,'8000452450'
,'7001056571'
,'7000453243'
,'7002246670'
,'7000453995'
,'7000455205'
,'7002357970'
,'7000461311'
,'7000463621'
,'7002250251'
,'7000468965'
,'7000488382'
,'7000489420'
,'7000502220'
,'7000506514'
,'7001014068'
,'7000515682'
,'7002409779'
,'7000517952'
,'7000518291'
,'7000518294'
,'7000523276'
,'7012139656'
,'7004300368'
,'7000525564'
,'7000525821'
,'8000526590'
,'7000526870'
,'7000527238'
,'7000528460'
,'7000530082'
,'7000530206'
,'7003022770'
,'1712501'
,'7000532385'
,'7000533210'
,'7000534949'
,'7000538364'
,'7000539942'
,'438126'
,'7000541642'
,'7001398913'
,'7000546521'
,'336723'
,'7000547628'
,'7000547805'
,'7002524771'
,'8000551280'
,'7000551961'
,'7000552058'
,'7000553712'
,'7000553756'
,'7000554680'
,'7000558413'
,'7000564073'
,'7000567432'
,'7003705184'
,'7002468998'
,'7004282494'
,'7000573161'
,'7000574819'
,'7000575385'
,'7000576528'
,'7002219935'
,'7000581725'
,'7000581900'
,'7000585367'
,'7003249141'
,'7000586159'
,'825755'
,'7000589491'
,'7000590095'
,'7000591503'
,'7000592403'
,'7000593583'
,'7002906284'
,'7000594758'
,'7000595796'
,'7000599419'
,'7000602535'
,'7004615826'
,'7000607816'
,'7003201780'
,'7005538338'
,'7000614427'
,'7000617999'
,'7000624158'
,'7000629380'
,'640958'
,'7000629981'
,'7000630128'
,'7000391130'
,'7000631477'
,'7000631827'
,'7000651782'
,'7000652175'
,'7000652250'
,'7000652897'
,'1187245'
,'7003510914'
,'7000653735'
,'7000654934'
,'7004868075'
,'7000659425'
,'7000660374'
,'7000663340'
,'7000663856'
,'7000665442'
,'7000666457'
,'7000670188'
,'7000671901'
,'7003705468'
,'7000671929'
,'7000674181'
,'7000674403'
,'7000676003'
,'7000678641'
,'7000679162'
,'7000681197'
,'7000683491'
,'7000686143'
,'7002948441'
,'7000687168'
,'7000688724'
,'7000690561'
,'7000691731'
,'7000692997'
,'7000695739'
,'7000697448'
,'7000697942'
,'7007269275'
,'7000702827'
,'7003297554'
,'7002949768'
,'7000707792'
,'7000708367'
,'639512'
,'7000710008'
,'7000710163'
,'7000710221'
,'12218147'
,'7000711995'
,'7000714118'
,'7000716768'
,'7000719291'
,'7001565440'
,'7001035495'
,'7002989938'
,'7000725265'
,'7000725275'
,'7000727572'
,'7000728369'
,'7000728515'
,'303256'
,'7002621995'
,'7000730777'
,'7000735830'
,'7003404434'
,'7000737122'
,'7000742329'
,'7000742679'
,'7000743865'
,'7000744400'
,'7000744946'
,'7000817138'
,'7000760262'
,'7000760683'
,'7000765660'
,'7000766380'
,'7000767548'
,'7000769634'
,'7000772597'
,'7000774188'
,'523772'
,'7000784477'
,'7000785872'
,'7000787521'
,'7003209488'
,'7000790050'
,'8000791550'
,'7000792579'
,'7000796697'
,'7000796831'
,'7000798827'
,'7000802828'
,'7000807263'
,'7000808342'
,'7000808615'
,'7000809321'
,'7000813723'
,'7000814066'
,'7003261438'
,'367666'
,'7002817352'
,'7000825767'
,'7003818206'
,'7000827741'
,'7000827767'
,'7000828087'
,'7000829200'
,'7000833172'
,'7000834859'
,'7000838422'
,'7000838441'
,'7002693618'
,'7000839530'
,'7000840485'
,'7000843869'
,'7000846458'
,'7000848522'
,'7000849231'
,'7000851622'
,'7000852580'
,'7000853848'
,'7000855047'
,'7000855646'
,'7000855965'
,'7000856120'
,'7000859324'
,'7000861449'
,'7000866304'
,'7000866592'
,'7000869306'
,'7004623065'
,'7000880734'
,'7000881882'
,'7000882967'
,'7000884287'
,'7000885593'
,'7000886466'
,'7000886547'
,'7002208121'
,'7000890901'
,'902575'
,'7000891721'
,'7000892503'
,'7000892803'
,'7000893056'
,'7000900039'
,'7000901980'
,'7000902371'
,'7000906063'
,'7000907751'
,'7000908925'
,'7000911301'
,'7004300915'
,'7003276872'
,'7000914938'
,'7000915223'
,'7000916283'
,'7000918079'
,'7000919864'
,'7001289430'
,'7000921278'
,'7000921720'
,'7000922819'
,'7000922989'
,'7002782101'
,'7000925282'
,'7000925708'
,'7000925943'
,'7000926325'
,'7002085255'
,'7000928109'
,'7000928921'
,'7000930366'
,'7004320619'
,'7000931384'
,'7000932055'
,'7002532816'
,'7000934537'
,'7000935868'
,'7000936908'
,'7002282623'
,'7000941232'
,'7000943313'
,'7004094166'
,'7003271766'
,'7000949183'
,'7000953793'
,'7000954961'
,'7000957282'
,'7001006204'
,'7000957954'
,'7000957970'
,'1152619'
,'7000960605'
,'7000961429'
,'7000966959'
,'7000969587'
,'7000970690'
,'7000970781'
,'7000972008'
,'7003619583'
,'7000977022'
,'7002251805'
,'7000982077'
,'7001055150'
,'7000984009'
,'7000986200'
,'7193902'
,'7011164717'
,'7000990241'
,'7000991181'
,'7000991636'
,'7000992069'
,'7000993267'
,'7000993415'
,'7000995543'
,'7000999400'
,'7001000069'
,'7001002098'
,'7001009233'
,'7001009550'
,'7001010074'
,'7001010436'
,'7001011197'
,'7001012720'
,'7001013342'
,'7003843449'
,'7010290794'
,'7001016934'
,'7001018189'
,'7005123449'
,'7001023723'
,'7001024117'
,'7001024163'
,'7002247002'
,'7001026851'
,'7001026858'
,'7001028504'
,'7001028939'
,'7001032748'
,'7001033096'
,'7001033754'
,'7001035650'
,'7001036988'
,'7001038254'
,'7001038914'
,'7001040365'
,'7001040815'
,'7001041504'
,'7001042011'
,'7001043274'
,'7001046536'
,'7001047017'
,'7001048188'
,'6708972'
,'7001052120'
,'7001053676'
,'7001054550'
,'7001058253'
,'7001059245'
,'7001060253'
,'7001060817'
,'7001061091'
,'7001067846'
,'7010241509'
,'7001068116'
,'7001070877'
,'7001072382'
,'7001074735'
,'7001075999'
,'7001076704'
,'7001076778'
,'7001079159'
,'7001079654'
,'7001080926'
,'7013117975'
,'7001083204'
,'7001083636'
,'7001084092'
,'7001086662'
,'6695841'
,'7001088817'
,'7001088913'
,'7001090198'
,'7001093140'
,'7001096123'
,'7001286751'
,'7001098831'
,'7001099489'
,'7001100828'
,'7001101588'
,'7001101913'
,'7001105252'
,'7001105287'
,'7001106098'
,'7004953243'
,'7001109138'
,'7001110402'
,'7001110561'
,'7001112456'
,'7001113352'
,'354936'
,'7001116614'
,'7001116790'
,'7001117655'
,'7001118692'
,'7001119436'
,'7001120662'
,'7002045194'
,'7001122499'
,'7001123348'
,'7001125525'
,'7001128460'
,'7001129322'
,'7001130528'
,'7001131671'
,'933359'
,'7001137107'
,'7001137144'
,'7001139646'
,'7001140532'
,'7001146058'
,'7001148271'
,'7001149110'
,'7003611177'
,'7003502707'
,'7084896'
,'7001151307'
,'7001151318'
,'7001153884'
,'7001154401'
,'7001154440'
,'7001157983'
,'7001158829'
,'7001165315'
,'7001169883'
,'7001170095'
,'7001171903'
,'7001274486'
,'7001176002'
,'492736'
,'7001179964'
,'7001181515'
,'7001183622'
,'7001190863'
,'7001193004'
,'7001196429'
,'7001198318'
,'7001198670'
,'7001201140'
,'7001202091'
,'7001203208'
,'7001204957'
,'7001742640'
,'7001207204'
,'7001207996'
,'7001209893'
,'7001212607'
,'7013750520'
,'7001214212'
,'573983'
,'7001220301'
,'7001222773'
,'8001223581'
,'7001223853'
,'7001225782'
,'8001226470'
,'8001228380'
,'7003405809'
,'7001235594'
,'7004641285'
,'7001243028'
,'7001243711'
,'7001248694'
,'7001248758'
,'7002094591'
,'7001253823'
,'7001256422'
,'7001257090'
,'7011161327'
,'7001258843'
,'7001259159'
,'7001259729'
,'493466'
,'651479'
,'7001264268'
,'7001264680'
,'7001267416'
,'7001267746'
,'12191995'
,'7001268528'
,'7001270365'
,'7001270557'
,'7001413951'
,'7001271034'
,'7001271174'
,'7002268405'
,'7001275623'
,'7001271783'
,'7001271807'
,'7002552196'
,'7001277209'
,'7001277669'
,'7010168280'
,'7001284307'
,'7001284822'
,'7001288028'
,'7001288052'
,'7001291806'
,'7001292197'
,'7001293153'
,'7003428359'
,'7001295533'
,'7001295670'
,'7001296582'
,'7001296707'
,'7001297237'
,'7001298271'
,'7002271035'
,'7001299954'
,'7001305075'
,'7001308430'
,'8001308440'
,'7001308648'
,'7001309413'
,'7001309938'
,'7001311279'
,'7001954393'
,'7001313903'
,'7001321048'
,'7001325046'
,'8001325700'
,'7001334776'
,'7001328951'
,'7002302084'
,'7001330354'
,'7001534003'
,'7001335426'
,'7001337893'
,'7001339402'
,'7003024596'
,'7001340941'
,'7001341232'
,'7001343000'
,'7001349630'
,'7001349836'
,'7001349851'
,'7001352417'
,'7001352695'
,'7001353319'
,'7001353791'
,'7001353947'
,'7001354201'
,'7001357793'
,'7001365079'
,'7005450790'
,'7001365468'
,'7001366292'
,'359494'
,'7001369692'
,'7001370191'
,'7001374541'
,'7001378469'
,'7002503621'
,'7001381509'
,'7003092861'
,'7001382715'
,'7001385145'
,'7001386285'
,'7001387972'
,'7001389401'
,'7001391599'
,'1152618'
,'7001392352'
,'7001392378'
,'8001394690'
,'7001396943'
,'7001397590'
,'7001397700'
,'7001400680'
,'763827'
,'7001405016'
,'7001405077'
,'7001405118'
,'7001407254'
,'8001409920'
,'12125968'
,'7001412088'
,'7001412910'
,'7001413451'
,'7001631670'
,'7001413927'
,'7001419529'
,'7003764331'
,'7001423638'
,'7001423686'
,'7001423849'
,'7002423169'
,'12809913'
,'7001430798'
,'7001433185'
,'7002784657'
,'7001434736'
,'7001435840'
,'7001437140'
,'7001979334'
,'7001440945'
,'6410263'
,'7001441651'
,'7001442638'
,'7001445622'
,'7003283896'
,'7004095542'
,'7004859709'
,'7001448601'
,'7001451111'
,'7002750180'
,'7001452237'
,'7001453928'
,'7001454622'
,'7001455806'
,'7001456777'
,'7001457544'
,'7001458779'
,'7004306125'
,'7001462796'
,'7001464443'
,'7001465607'
,'7001467735'
,'7001467867'
,'7003078650'
,'7001468847'
,'7001472579'
,'7001474093'
,'7001474793'
,'7001475866'
,'7001477223'
,'7001480182'
,'7001480485'
,'7001480956'
,'7001483707'
,'7001484409'
,'7001484447'
,'7001485450'
,'7001485891'
,'360631'
,'7001486849'
,'7001490639'
,'7001490751'
,'7001491458'
,'7001491877'
,'7001492585'
,'7001492976'
,'7001493208'
,'7001493268'
,'8001494250'
,'12140849'
,'7001494863'
,'7001495660'
,'7124828'
,'7001569731'
,'7001499500'
,'7001501236'
,'7001501846'
,'7001502989'
,'7001505923'
,'7001506752'
,'7001509221'
,'7001510117'
,'7001510799'
,'7001511575'
,'7001512300'
,'7001513019'
,'7001513304'
,'7001513342'
,'7002823507'
,'7001517527'
,'7001519069'
,'7001519366'
,'7002057890'
,'7001520170'
,'7001521099'
,'7001522705'
,'7001523029'
,'8001525800'
,'7001525852'
,'7002744054'
,'7001528131'
,'7001528495'
,'7001528507'
,'7001528936'
,'7001529499'
,'7001531123'
,'7001531527'
,'7001531960'
,'7001532500'
,'7001534188'
,'7001534486'
,'7001534719'
,'7001536748'
,'7001536892'
,'7001537501'
,'7001537904'
,'7001538158'
,'7001538288'
,'7001539873'
,'7001540492'
,'7002532359'
,'7002710493'
,'7001542147'
,'7001542448'
,'7001543417'
,'7001543860'
,'7001543861'
,'7002245460'
,'7001544035'
,'7001544414'
,'7003618505'
,'7001545086'
,'2040493'
,'7001547166'
,'7001547485'
,'7001548237'
,'7001548745'
,'7001548761'
,'7001548817'
,'7001549187'
,'6400075'
,'7001551034'
,'7001551125'
,'7001552533'
,'7003822473'
,'7001553491'
,'7001555069'
,'7001556845'
,'7001557463'
,'7001557876'
,'7001561273'
,'7001562530'
,'7001562568'
,'7001564536'
,'7001568295'
,'7001571236'
,'7001572027'
,'524428'
,'7001574138'
,'7001577488'
,'7001578677'
,'7001579056'
,'7001579622'
,'7001579889'
,'7001582049'
,'7001582193'
,'7001582337'
,'7001582498'
,'7001586625'
,'7001586819'
,'7001587736'
,'7001587838'
,'7001587965'
,'7001588718'
,'7001588761'
,'7001589282'
,'7001589792'
,'8001591620'
,'7001592912'
,'7001595899'
,'7001597237'
,'7001598122'
,'7001599066'
,'7001599645'
,'7001599827'
,'7001600565'
,'7001602144'
            )
            
            
    order by ndgControparte
""")
.resultList

def wq = []

def k = p.groupBy{
    it.ndg
}


k.count { key, value -> 

    value.size() > 1 
    
    if(value.size() > 1)
        wq << value.ndg.unique().join()
}


wq.toString()








